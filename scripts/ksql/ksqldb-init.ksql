CREATE TYPE Identity AS STRUCT<IdentityGuid VARCHAR, IdentityKind VARCHAR>;

CREATE OR REPLACE STREAM capabilities
(Identity Identity)
WITH (VALUE_FORMAT='PROTOBUF', KAFKA_TOPIC='capability_topic');

CREATE OR REPLACE STREAM capability_stream
WITH (VALUE_FORMAT='PROTOBUF', KAFKA_TOPIC='capability_stream_topic')
AS SELECT *
FROM capabilities
PARTITION BY Identity->IdentityKind
EMIT CHANGES;

LIST TOPICS;

LIST STREAMS;